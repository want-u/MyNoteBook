# 排查-端口信息

[toc]

[漏洞] 端口 进程 服务

## 服务例: 80 端口

1、lsof -i:80 # 进程号为8473 (或 netstat -anplt | grep 80)

```
COMMAND  PID     USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
apache2 8473     root    6u  IPv6  33397      0t0  TCP *:http (LISTEN)
apache2 8476 www-data    6u  IPv6  33397      0t0  TCP *:http (LISTEN)
apache2 8477 www-data    6u  IPv6  33397      0t0  TCP *:http (LISTEN)

```
2、ps -ef | grep 8473 # /usr/sbin/apache2 阿帕奇web服务
```
root      8473  5468  0 16:10 ?        00:00:00 /usr/sbin/apache2 -k start
www-data  8476  8473  0 16:10 ?        00:00:00 /usr/sbin/apache2 -k start
www-data  8477  8473  0 16:10 ?        00:00:00 /usr/sbin/apache2 -k start
root      8580  5470  0 16:13 pts/3    00:00:00 grep --color=auto --exclude-dir=.bzr --exclude-dir=CVS --exclude-dir=.git --exclude-dir=.hg --exclude-dir=.svn --exclude-dir=.idea --exclude-dir=.tox 8473

```



## 容器例: 9200 端口

1、lsof -i:9200 # IPv4进程号为1330
```

COMMAND    PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
docker-pr 1330 root    4u  IPv4  22657      0t0  TCP *:9200 (LISTEN)
docker-pr 1337 root    4u  IPv6   1453      0t0  TCP *:9200 (LISTEN)
```
2、ps -ef| grep 1330 # 查看进程信息，docker容器ip为172.19.0.2

```
root      1330   484  0 15:47 ?        00:00:00 /usr/bin/docker-proxy -proto tcp -host-ip 0.0.0.0 -host-port 9200 -container-ip 172.19.0.2 -container-port 9200
root      5545  5470  0 15:51 pts/3    00:00:00 grep --color=auto --exclude-dir=.bzr --exclude-dir=CVS --exclude-dir=.git --exclude-dir=.hg --exclude-dir=.svn --exclude-dir=.idea --exclude-dir=.tox 1330
```
3、for i in $(docker ps -q); do echo $i; docker inspect $i | grep 172.19.0.2; done # 查找容器id

```
b333f32bde3d
1e1bba671b93
d4dc1b738ba4
e6c9381495ee
d45039d50180
910f89f80533
d111604bbdcb
                    "IPAddress": "172.19.0.2",
```
4、docker ps | grep d111604bbdcb # 查看容器

```
d111604bbdcb   docker.elastic.co/elasticsearch/elasticsearch:6.8.1   "/usr/local/bin/dock…"   2 days ago     Up 4 minutes   0.0.0.0:9200->9200/tcp, :::9200->9200/tcp, 0.0.0.0:9300->9300/tcp, :::9300->9300/tcp   elasticsearch
```
